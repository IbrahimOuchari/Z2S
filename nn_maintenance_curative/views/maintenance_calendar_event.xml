<odoo>

    <!-- Menu: Equipments -->
    <menuitem
            id="maintenance.menu_equipment_form"
            name="Equipements"
            parent="maintenance.menu_maintenance_title"
            groups="maintenance.group_equipment_manager,base.group_user"
            sequence="2"/>

    <!-- Submenu: List of Equipments -->
    <menuitem
            id="maintenance.menu_equipment_form_list"
            name="Liste des équipements"
            parent="maintenance.menu_equipment_form"
            action="maintenance.hr_equipment_action"
            sequence="1"
            groups="maintenance.group_equipment_manager,base.group_user"/>
    <record id="view_maintenance_calendar_event_line_tree" model="ir.ui.view">
        <field name="name">maintenance.calendar.event.line.tree</field>
        <field name="model">maintenance.calendar.event.line</field>
        <field name="arch" type="xml">
            <tree string="Lignes d'événements de maintenance" default_order="date asc">
                <field name="date"/>
                <field name="name"/>
                <field name="equipment_id"/>
                <field name="period_count"/>
            </tree>
        </field>
    </record>

    <!-- Search V   iew: for Maintenance Calendar Event Lines -->
    <record id="view_maintenance_calendar_event_line_search" model="ir.ui.view">
        <field name="name">maintenance.calendar.event.line.search</field>
        <field name="model">maintenance.calendar.event.line</field>
        <field name="arch" type="xml">
            <search string="Recherche planning maintenance">
                <!-- Search Fields -->
                <field name="equipment_id" string="Équipement"/>
                <field name="period_count" string="Fréquence"/>
                <field name="date" string="Date"/>
                <field name="name" string="Nom"/>
                <field name="event_id" string="Événement"/>

                <!-- Quick Filters -->
                <filter name="today" string="Aujourd'hui"
                        domain="[('date', '=', context_today().strftime('%Y-%m-%d'))]"/>
                <filter name="this_week" string="Cette semaine"
                        domain="[('date', '>=', (context_today() - datetime.timedelta(days=context_today().weekday())).strftime('%Y-%m-%d')),
                                ('date', '&lt;=', (context_today() + datetime.timedelta(days=6 - context_today().weekday())).strftime('%Y-%m-%d'))]"/>
                <filter name="this_month" string="Ce mois"
                        domain="[
                            ('date', '>=', context_today().replace(day=1).strftime('%Y-%m-%d')),
                            ('date', '&lt;=', ((context_today().replace(day=1) + datetime.timedelta(days=32)).replace(day=1) - datetime.timedelta(days=1)).strftime('%Y-%m-%d'))
                        ]"/>
                <filter name="next_month" string="Mois prochain"
                        domain="[('date', '>=', (context_today().replace(day=1) + datetime.timedelta(days=32)).replace(day=1).strftime('%Y-%m-%d')),
                                ('date', '&lt;=', ((context_today().replace(day=1) + datetime.timedelta(days=62)).replace(day=1) - datetime.timedelta(days=1)).strftime('%Y-%m-%d'))]"/>

                <separator/>

                <!-- Frequency Filters -->
                <filter name="monthly" string="Mensuelle" domain="[('period_count', '=', '1')]"/>
                <filter name="quarterly" string="Trimestrielle" domain="[('period_count', '=', '2')]"/>
                <filter name="semi_annual" string="Semestrielle" domain="[('period_count', '=', '3')]"/>
                <filter name="annual" string="Annuelle" domain="[('period_count', '=', '4')]"/>

                <separator/>

                <!-- Date Range Filters -->
                <filter name="past_due" string="En retard"
                        domain="[('date', '&lt;', context_today().strftime('%Y-%m-%d'))]"/>
                <filter name="upcoming" string="À venir"
                        domain="[('date', '>', context_today().strftime('%Y-%m-%d'))]"/>
                <filter name="next_7_days" string="7 prochains jours"
                        domain="[('date', '>=', context_today().strftime('%Y-%m-%d')),
                                ('date', '&lt;=', (context_today() + datetime.timedelta(days=7)).strftime('%Y-%m-%d'))]"/>
                <filter name="next_30_days" string="30 prochains jours"
                        domain="[('date', '>=', context_today().strftime('%Y-%m-%d')),
                                ('date', '&lt;=', (context_today() + datetime.timedelta(days=30)).strftime('%Y-%m-%d'))]"/>

                <!-- Group By -->
                <group expand="0" string="Regrouper par">
                    <filter name="group_by_equipment" string="Équipement" context="{'group_by': 'equipment_id'}"/>
                    <filter name="group_by_period" string="Fréquence" context="{'group_by': 'period_count'}"/>
                    <filter name="group_by_date" string="Date" context="{'group_by': 'date:day'}"/>
                    <filter name="group_by_week" string="Semaine" context="{'group_by': 'date:week'}"/>
                    <filter name="group_by_month" string="Mois" context="{'group_by': 'date:month'}"/>
                    <filter name="group_by_quarter" string="Trimestre" context="{'group_by': 'date:quarter'}"/>
                    <filter name="group_by_year" string="Année" context="{'group_by': 'date:year'}"/>
                </group>
            </search>
        </field>
    </record>


    <!-- Calendar View: Maintenance Calendar Event Lines -->
    <record id="view_maintenance_calendar_event_line_calendar" model="ir.ui.view">
        <field name="name">maintenance.calendar.event.line.calendar</field>
        <field name="model">maintenance.calendar.event.line</field>
        <field name="arch" type="xml">
            <calendar string="Planning de maintenance"
                      date_start="date"
                      color="period_count"
                      event_limit="5"
                      quick_add="false">
                <field name="equipment_id"/>
                <field name="period_count"/>
                <field name="event_id"/>
            </calendar>
        </field>
    </record>

    <!-- Action: Open Calendar + Search -->
    <record id="action_maintenance_calendar_event" model="ir.actions.act_window">
        <field name="name">Planning Maintenance</field>
        <field name="res_model">maintenance.calendar.event.line</field>
        <field name="view_mode">calendar,tree,form</field>
        <field name="view_id" ref="view_maintenance_calendar_event_line_calendar"/>
        <field name="search_view_id" ref="view_maintenance_calendar_event_line_search"/>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Cliquez pour planifier un nouvel événement de maintenance.
            </p>
        </field>
    </record>

    <!-- Menu: Open Planning -->
    <menuitem
            id="menu_maintenance_calendar_event"
            name="Planning de maintenance"
            parent="maintenance.menu_equipment_form"
            action="action_maintenance_calendar_event"
            sequence="2"
            groups="maintenance.group_equipment_manager,base.group_user"/>

</odoo>
